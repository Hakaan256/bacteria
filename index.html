<html>
<head>
<style type='text/css'>
body,div
{
  position:relative;
  overflow:auto;
  margin:0px;
  padding:0px;
  font-family:Helvetica Neue;
  font-size:18px;
}
body
{
}
.convo
{
  width:100%;
  background-color:#FBF0EE;
}
.convo_content
{
  width:824px;
  margin:0px auto;
  padding-top:40px;
  padding-bottom:40px;
}

.chat
{
  width:100%;
  padding-top:0px;
  padding-bottom:0px;
}
.chat_img
{
  width:100px;
  height:100px;
  float:left;
}
.chat_txt
{
  padding-top:20px;
  float:left;
  width:704px;
}

.short_img
{
  background-image:url('assets/jack_circle.png');
  background-size:100px 100px;
}
.tall_img
{
  background-image:url('assets/scout_circle.png');
  background-size:100px 100px;
}
.short_txt
{
  padding-left:20px;
  text-align:left;
}
.tall_txt
{
  padding-right:20px;
  text-align:right;
}

.experiment
{
  width:100%;
}
.experiment_content
{
  width:1024px;
}

.experiment /* outer_width: 260*2 + 258 */
{
  margin:0px auto;
  width:798px;
}
.rules /* outer_width: 270 */
{
  width:250px;
  padding:10px;
  min-height:10px;
  float:left;
  font-size:16px;
}
.rule
{
  font-style:italic;
}
.new
{
  font-weight:bold;
}
.stage_container /* outer_width:256+2(border) */
{
  width:258px;
  overflow:visible;
  user-select:none;
}
.keyword
{
  font-style:italic;
}
</style>
<script type='text/javascript' src='src/config.js'></script>
<script type='text/javascript' src='src/utils/utils.js'></script>
<script type='text/javascript' src='src/utils/webgl-utils.js'></script>
<script type="text/javascript" src="src/canv.js"></script>
<script type="text/javascript" src="src/stage.js"></script>
<script type="text/javascript" src="src/game.js"></script>

<script type="text/javascript" src="src/doqueues/assetter.js"></script>
<script type="text/javascript" src="src/doqueues/clicker.js"></script>
<script type="text/javascript" src="src/doqueues/blurer.js"></script>
<script type="text/javascript" src="src/doqueues/keyer.js"></script>
<script type="text/javascript" src="src/doqueues/debugger.js"></script>
<script type="text/javascript" src="src/doqueues/dragger.js"></script>
<script type="text/javascript" src="src/doqueues/drawer.js"></script>
<script type="text/javascript" src="src/doqueues/flicker.js"></script>
<script type="text/javascript" src="src/doqueues/hoverer.js"></script>
<script type="text/javascript" src="src/doqueues/persistent_hoverer.js"></script>
<script type="text/javascript" src="src/doqueues/presser.js"></script>
<script type="text/javascript" src="src/doqueues/ticker.js"></script>
<script type="text/javascript" src="src/doqueues/particler.js"></script>
<script type="text/javascript" src="src/doqueues/objs/img.js"></script>
<script type="text/javascript" src="src/doqueues/objs/placer.js"></script>
<script type="text/javascript" src="src/doqueues/objs/input.js"></script>

<script type="text/javascript" src="src/scenes/nullScene.js"></script>
<script type="text/javascript" src="src/scenes/loadingScene.js"></script>
<script type="text/javascript" src="src/scenes/testScene.js"></script>
<script type="text/javascript" src="src/scenes/gameplayScene.js"></script>

<script type="text/javascript">
function $(id)
{
  return document.getElementById(id);
}

var d;
var g;
var g_basic;
var games = {};

function size_prefix(w,h,prefix)
{
  $(prefix+"experiment_content").style.width  = (w+2)+"px";
  $(prefix+"experiment_content").style.height = (h+52)+"px";
  $(prefix+"stage_container").style.width  = (w+2)+"px";
  $(prefix+"stage_container").style.height = (h)+"px";
}
function goExperiment()
{
  var prefix = "";
  var w = 640;
  var h = 320;

  var special = SPECIAL_NONE;
  var grid_x = 0;
  var grid_y = 0;
  var grid_w = -1;
  var grid_h = -1;
  var grid_cols = parseInt($("experiment_grid_cols").value);
  var grid_rows = parseInt($("experiment_grid_rows").value);
  var colored_rgb = $("experiment_attribute_color_rgb").checked;
  var default_r = 0.5;
  var default_g = 0.5;
  var default_b = 0.5;
  var colored_hsl = $("experiment_attribute_color_hsl").checked;
  var default_h = 150;
  var default_s = 1;
  var default_l = 0.7;
  var colorblind = false;
  var sim_speed = parseFloat($("experiment_sim_speed").value);
  var badb_sim_speed = 1;
  var allow_sim_speed_slider = false;
  var sim_speed_min = 1;
  var sim_speed_max = 2;
  var hover_to_play = true;
  var display_pause = true;
  var allow_dose_slider = $("experiment_allow_dose_slider").checked;
  var allow_dose_button = $("experiment_allow_dose_button").checked;
  var dose_chip_damage = $("experiment_dose_chip_damage").checked;
  var allow_smile = false;
  var allow_reset = true;
  var prompt_reset_on_empty = false;
  var allow_contaminate = false;
  var default_badb_resist = 0.;
  var init_badb = $("experiment_init_badb").checked;
  var reinit_badb = false;
  var default_good_resist = 0.;
  var allow_good = true;
  var init_good = $("experiment_init_good").checked;
  var reinit_good = false;
  var allow_body = true;
  var init_body = $("experiment_init_body").checked;
  var reinit_body = false;
  var swab_size = $("experiment_big_swab").checked ? 2 : 1;
  var click_function = $("experiment_click_func_none").checked ? CLICK_FUNC_NONE : $("experiment_click_func_badb").checked ? CLICK_FUNC_BADB : $("experiment_click_func_good").checked ? CLICK_FUNC_GOOD : $("experiment_click_func_body").checked ? CLICK_FUNC_BODY : $("experiment_click_func_kill").checked ? CLICK_FUNC_KILL : CLICK_FUNC_NONE;
  var hover_function = $("experiment_hover_func_none").checked ? CLICK_FUNC_NONE : $("experiment_hover_func_badb").checked ? CLICK_FUNC_BADB : $("experiment_hover_func_good").checked ? CLICK_FUNC_GOOD : $("experiment_hover_func_body").checked ? CLICK_FUNC_BODY : $("experiment_hover_func_kill").checked ? CLICK_FUNC_KILL : CLICK_FUNC_NONE;
  var show_hover = true;
  var prerequisite_fill_for_interaction = 0.;
  var prompt_prerequisite_unmet = false;
  var mutate_random_assign = $("experiment_mutate_random").checked;
  var mutate_rate = parseFloat($("experiment_mutate_rate").value);
  var mutate_distance = parseFloat($("experiment_mutate_distance").value);
  var bias_mutate = false;
  var reproduce = $("experiment_reproduce").checked;
  var age = $("experiment_age").checked;
  var ave_display_width = (!colored_rgb && !colored_hsl) ? 10 : 0;
  var split_display_width = (!colored_rgb && !colored_hsl && init_badb && init_good) ? 10 : 0;
  var tricolor_display_width = colored_rgb ? 10 : 0;
  var hsl_display_width = colored_hsl ? 10 : 0;


  prefix = "experiment_";
  var expcontainer = $(prefix+"stage_container");
  while(expcontainer.firstChild) expcontainer.removeChild(expcontainer.firstChild);

  w = 256 + ave_display_width + split_display_width + tricolor_display_width + hsl_display_width;
  grid_w = 256; //hardcoded...
  h = 256;
  size_prefix(w,h,prefix);
  g = new Game({width:w,height:h,container:prefix+"stage_container",popup:prefix+"popup",
    config:
    {
      special:special,
      grid_x:grid_x,
      grid_y:grid_y,
      grid_w:grid_w,
      grid_h:grid_h,
      grid_cols:grid_cols,
      grid_rows:grid_rows,
      colored_rgb:colored_rgb,
      default_r:default_r,
      default_g:default_g,
      default_b:default_b,
      colored_hsl:colored_hsl,
      default_h:default_h,
      default_s:default_s,
      default_l:default_l,
      colorblind:colorblind,
      sim_speed:sim_speed,
      badb_sim_speed:badb_sim_speed,
      allow_sim_speed_slider:allow_sim_speed_slider,
      sim_speed_min:sim_speed_min,
      sim_speed_max:sim_speed_max,
      hover_to_play:hover_to_play,
      display_pause:display_pause,
      allow_dose_slider:allow_dose_slider,
      allow_dose_button:allow_dose_button,
      dose_chip_damage:dose_chip_damage,
      allow_smile:allow_smile,
      allow_reset:allow_reset,
      prompt_reset_on_empty:prompt_reset_on_empty,
      allow_contaminate:allow_contaminate,
      default_badb_resist:default_badb_resist,
      init_badb:init_badb,
      reinit_badb:reinit_badb,
      default_good_resist:default_good_resist,
      allow_good:allow_good,
      init_good:init_good,
      reinit_good:reinit_good,
      allow_body:allow_body,
      init_body:init_body,
      reinit_body:reinit_body,
      swab_size:swab_size,
      click_function:click_function,
      hover_function:hover_function,
      show_hover:show_hover,
      prerequisite_fill_for_interaction:prerequisite_fill_for_interaction,
      prompt_prerequisite_unmet:prompt_prerequisite_unmet,
      mutate_random_assign:mutate_random_assign,
      mutate_rate:mutate_rate,
      mutate_distance:mutate_distance,
      bias_mutate:bias_mutate,
      reproduce:reproduce,
      age:age,
      ave_display_width:ave_display_width,
      split_display_width:split_display_width,
      tricolor_display_width:tricolor_display_width,
      hsl_display_width:hsl_display_width,
    }
  });
  games[prefix] = g;
  g.begin();
}

function begin()
{
  var prefix = "";
  var w = 640;
  var h = 320;
  //$("debug_div").style.width  = w+"px";
  //$("debug_div").style.height = h+"px";
  //d = new Debugger({source:$("debug_div")});

  prefix = "basic_";
  w = 256;
  h = 256;
  size_prefix(w,h,prefix);
  g = new Game({width:w,height:h,container:prefix+"stage_container",popup:prefix+"popup",
    config:
    {
      special:SPECIAL_NONE,
      grid_x:0,
      grid_y:0,
      grid_w:-1,
      grid_h:-1,
      grid_cols:10,
      grid_rows:10,
      colored_rgb:false,
      default_r:0.5,
      default_g:0.5,
      default_b:0.5,
      colored_hsl:false,
      default_h:150,
      default_s:1,
      default_l:0.7,
      colorblind:false,
      sim_speed:1,
      badb_sim_speed:1,
      allow_sim_speed_slider:false,
      sim_speed_min:1,
      sim_speed_max:2,
      hover_to_play:true,
      display_pause:true,
      allow_dose_slider:false,
      allow_dose_button:false,
      dose_chip_damage:false,
      allow_smile:false,
      allow_reset:true,
      prompt_reset_on_empty:false,
      allow_contaminate:false,
      default_badb_resist:0.,
      init_badb:false,
      reinit_badb:false,
      default_good_resist:0.,
      allow_good:false,
      init_good:false,
      reinit_good:false,
      allow_body:false,
      init_body:false,
      reinit_body:false,
      swab_size:1,
      click_function:CLICK_FUNC_BADB,
      hover_function:CLICK_FUNC_NONE,
      show_hover:false,
      prerequisite_fill_for_interaction:0.,
      prompt_prerequisite_unmet:false,
      mutate_random_assign:false,
      mutate_rate:0,
      mutate_distance:0,
      bias_mutate:false,
      reproduce:true,
      age:true,
      ave_display_width:0,
      split_display_width:0,
      tricolor_display_width:0,
      hsl_display_width:0,
    }
  });
  games[prefix] = g;
  g.begin();

  prefix = "biodiversity_";
  w = 256;
  h = 256;
  size_prefix(w,h,prefix);
  g = new Game({width:w,height:h,container:prefix+"stage_container",popup:prefix+"popup",
    config:
    {
      special:SPECIAL_NONE,
      grid_x:0,
      grid_y:0,
      grid_w:-1,
      grid_h:-1,
      grid_cols:10,
      grid_rows:10,
      colored_rgb:false,
      default_r:0.5,
      default_g:0.5,
      default_b:0.5,
      colored_hsl:false,
      default_h:150,
      default_s:1,
      default_l:0.7,
      colorblind:false,
      sim_speed:1,
      badb_sim_speed:1,
      allow_sim_speed_slider:false,
      sim_speed_min:1,
      sim_speed_max:2,
      hover_to_play:true,
      display_pause:true,
      allow_dose_slider:false,
      allow_dose_button:false,
      dose_chip_damage:false,
      allow_smile:false,
      allow_reset:true,
      prompt_reset_on_empty:false,
      allow_contaminate:false,
      default_badb_resist:0.,
      init_badb:false,
      reinit_badb:false,
      default_good_resist:0.,
      allow_good:false,
      init_good:false,
      reinit_good:false,
      allow_body:false,
      init_body:false,
      reinit_body:false,
      swab_size:1,
      click_function:CLICK_FUNC_BADB,
      hover_function:CLICK_FUNC_NONE,
      show_hover:false,
      prerequisite_fill_for_interaction:0.,
      prompt_prerequisite_unmet:false,
      mutate_random_assign:false,
      mutate_rate:1,
      mutate_distance:0.2,
      bias_mutate:false,
      reproduce:true,
      age:true,
      ave_display_width:0,
      split_display_width:0,
      tricolor_display_width:0,
      hsl_display_width:0,
    }
  });
  games[prefix] = g;
  g.begin();

  prefix = "killbutton_";
  w = 356;
  h = 256;
  size_prefix(w,h,prefix);
  g = new Game({width:w,height:h,container:prefix+"stage_container",popup:prefix+"popup",
    config:
    {
      special:SPECIAL_NONE,
      grid_x:0,
      grid_y:0,
      grid_w:256,
      grid_h:-1,
      grid_cols:10,
      grid_rows:10,
      colored_rgb:false,
      default_r:0.5,
      default_g:0.5,
      default_b:0.5,
      colored_hsl:false,
      default_h:150,
      default_s:1,
      default_l:0.7,
      colorblind:false,
      sim_speed:1,
      badb_sim_speed:1,
      allow_sim_speed_slider:false,
      sim_speed_min:1,
      sim_speed_max:2,
      hover_to_play:true,
      display_pause:true,
      allow_dose_slider:false,
      allow_dose_button:true,
      dose_chip_damage:true,
      allow_smile:false,
      allow_reset:true,
      prompt_reset_on_empty:true,
      allow_contaminate:false,
      default_badb_resist:0.,
      init_badb:true,
      reinit_badb:false,
      default_good_resist:0.,
      allow_good:false,
      init_good:false,
      reinit_good:false,
      allow_body:false,
      init_body:false,
      reinit_body:false,
      swab_size:1,
      click_function:CLICK_FUNC_NONE,
      hover_function:CLICK_FUNC_NONE,
      show_hover:false,
      prerequisite_fill_for_interaction:0.,
      prompt_prerequisite_unmet:false,
      mutate_random_assign:false,
      mutate_rate:1,
      mutate_distance:0.2,
      bias_mutate:false,
      reproduce:true,
      age:true,
      ave_display_width:10,
      split_display_width:0,
      tricolor_display_width:0,
      hsl_display_width:0,
    }
  });
  games[prefix] = g;
  g.begin();

  goExperiment();
}
window.addEventListener('touchstart', function(e){ e.preventDefault() }); //prevent browser from doing anything funny
window.addEventListener("load",begin,false);
</script>

</head>
<body>

<div id="header" style="height:400px; width:100%; background-image:url('assets/bacteria-header.jpg'); background-position:center; background-size:100%;">
  <div style="width:1024px; margin:0px auto;">
    <div style="padding:50px;">
      <div style="font-size:60px; color:#FFFFFF;">ANTIBIOTIC<br/>RESISTANCE.</div>
      <div style="color:#FFFFFF;"><img src="assets/icon-rocket-white.png" style="width:50px;"></img>AN INTERACTIVE EXPLORABLE</div>
    </div>
  </div>
</div>

<div class="convo">
  <div class="convo_content">

    <div class="chat short">
      <div class="chat_img short_img"></div><div class="chat_txt short_txt">BLARB</div>
    </div>
    <div class="chat tall">
      <div class="chat_txt tall_txt">BLARB</div><div class="chat_img tall_img"></div>
    </div>

    <div class="chat short">
      <div class="chat_img short_img"></div><div class="chat_txt short_txt">How can antibiotics be dangerous? I thought they made you better!</div>
    </div>
    <div class="chat tall">
      <div class="chat_txt tall_txt">Antibiotic resistance!</div><div class="chat_img tall_img"></div>
    </div>

    <div class="chat short">
      <div class="chat_img short_img"></div><div class="chat_txt short_txt">But what <i>is</i> antibiotic resistance?<br />Why is antibiotic resistance bad? What can we do about it?</div>
    </div>
    <div class="chat tall">
      <div class="chat_txt tall_txt">Tell you what, let's create a model to help us explore these questions.<br />Even though bacteria come in many shapes, in our model, they can be represented by squares.</div><div class="chat_img tall_img"></div>
    </div>

  </div>
</div>

<div class="experiment">
  <div class="experiment_content">
    <div class="rules">
      <br />
      <br />
      <br />
      In this Model:<br />
      <span class="rule new">- Bacteria are squares</span><br />
      <span class="rule new">- Bacteria sometimes reproduce</span><br />
      <span class="rule new">- Bacteria eventually die</span><br />
    </div>
    <div class="stage_container" id="basic_stage_container"> </div>
  </div>
</div>

<div class="convo">
  <div class="convo_content">

    <div class="chat short">
      <div class="chat_img short_img"></div><div class="chat_txt short_txt">BLARB</div>
    </div>
    <div class="chat tall">
      <div class="chat_txt tall_txt">BLARB</div><div class="chat_img tall_img"></div>
    </div>

  </div>
</div>

<div class="experiment">
  <div class="experiment_content">
    <div class="rules">
      <br />
      In this Model:<br />
      <span class="rule">- Bacteria are squares</span><br />
      <span class="rule">- Bacteria sometimes multiply</span><br />
      <span class="rule">- Bacteria eventually die</span><br />
      <span class="rule new">- Bacteria exhibit the attribute "lightness"</span><br />
      <span class="rule new">- Bacteria inherit thier attributes from their parents</span><br />
      <span class="rule new">- Bacteria sometimes mutate in their inherited attributes</span><br />
    </div>
    <div class="stage_container" id="biodiversity_stage_container"> </div>
  </div>
</div>

<div class="convo">
  <div class="convo_content">

    <div class="chat short">
      <div class="chat_img short_img"></div><div class="chat_txt short_txt">BLARB</div>
    </div>
    <div class="chat tall">
      <div class="chat_txt tall_txt">BLARB</div><div class="chat_img tall_img"></div>
    </div>

  </div>
</div>

<div class="experiment">
  <div class="experiment_content">
    <div class="rules">
      <br />
      In this Model:<br />
      <span class="rule">- Bacteria are squares</span><br />
      <span class="rule">- Bacteria sometimes multiply</span><br />
      <span class="rule">- Bacteria eventually die</span><br />
      <span class="rule new">- Bacteria exhibit the <span class="keyword">attribute</span> "antibiotic resistance"</span><br />
      <span class="rule">- Bacteria inherit thier attributes from their parents</span><br />
      <span class="rule">- Bacteria sometimes mutate in their inherited properties</span><br />
      <span class="rule new">- Bacteria with greater antibiotic resistance are harder to kill</span><br />
    </div>
    <div class="stage_container" id="killbutton_stage_container"> </div>
  </div>
</div>

</div>

</body>
</html>

